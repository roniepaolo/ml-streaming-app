#!/usr/sbin/nft -f

flush ruleset

table inet filter {
	chain input {
		type filter hook input priority 0;
		ct state established,related accept;
		ct state invalid drop;
		iifname lo accept;
		ip protocol icmp limit rate 10/second accept;
		ip protocol icmp drop;
		tcp dport ssh limit rate 15/minute accept;
		tcp dport 9888 limit rate 15/minute accept;
		tcp dport {http, https} accept;
		policy drop;
	}
	chain forward {
		type filter hook forward priority 0;
	}
	chain output {
		type filter hook output priority 0;
	}
}
